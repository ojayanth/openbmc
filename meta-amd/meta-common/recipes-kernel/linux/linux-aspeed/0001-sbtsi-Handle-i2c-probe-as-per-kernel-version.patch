From 238c2f3908409538eac2cd7deaeb394bc1df8c27 Mon Sep 17 00:00:00 2001
From: Akshay Gupta <Akshay.Gupta@amd.com>
Date: Mon, 21 Aug 2023 03:44:47 -0400
Subject: [PATCH 1/4] sbtsi: Handle i2c probe as per kernel version
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Following commit in linux kernel modifies the .probe() to
not take id parameter

commit 03c835f498b540087244a6757e87dfe7ef10999b
Author: Uwe Kleine-KÃ¶nig <u.kleine-koenig@pengutronix.de>
Date:   Sun Feb 26 23:26:52 2023 +0100

    i2c: Switch .probe() to not take an id parameter

    Commit b8a1a4cd5a98 ("i2c: Provide a temporary .probe_new()
call-back
    type") introduced a new probe callback to convert i2c init routines
to
    not take an i2c_device_id parameter. Now that all in-tree drivers
are
    converted to the temporary .probe_new() callback, .probe() can be
    modified to match the desired prototype.

    Now that .probe() and .probe_new() have the same semantic, they can
be
    defined as members of an anonymous union to save some memory and
    simplify the core code a bit.

Change-Id: I85c4595e91e976cb07616706ef689d982e23b849
Signed-off-by: Akshay Gupta <Akshay.Gupta@amd.com>
Signed-off-by: Naveen Krishna Chatradhi <naveenkrishna.chatradhi@amd.com>
---
 apml_sbtsi.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/apml_sbtsi.c b/apml_sbtsi.c
index b21560a..87193e2 100644
--- a/apml_sbtsi.c
+++ b/apml_sbtsi.c
@@ -327,8 +327,12 @@ static int sbtsi_i3c_probe(struct i3c_device *i3cdev)
 	return create_misc_tsi_device(tsi_dev, dev);
 }
 
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6, 3, 0)
 static int sbtsi_i2c_probe(struct i2c_client *client,
 			   const struct i2c_device_id *tsi_id)
+#else
+static int sbtsi_i2c_probe(struct i2c_client *client)
+#endif
 {
 	struct device *dev = &client->dev;
 	struct device *hwmon_dev;
-- 
2.39.3

