From f3e32ea8c4b6a67d4cb56ea53e2ae6ba64d6c6ab Mon Sep 17 00:00:00 2001
From: Akshay Gupta <Akshay.Gupta@amd.com>
Date: Mon, 21 Aug 2023 03:46:42 -0400
Subject: [PATCH 2/4] sbrmi: Handle i2c probe as per kernel version
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Following commit in linux kernel modifies the .probe() to
not take id parameter

commit 03c835f498b540087244a6757e87dfe7ef10999b
Author: Uwe Kleine-KÃ¶nig <u.kleine-koenig@pengutronix.de>
Date:   Sun Feb 26 23:26:52 2023 +0100

    i2c: Switch .probe() to not take an id parameter

    Commit b8a1a4cd5a98 ("i2c: Provide a temporary .probe_new()
call-back
    type") introduced a new probe callback to convert i2c init routines
to
    not take an i2c_device_id parameter. Now that all in-tree drivers
are
    converted to the temporary .probe_new() callback, .probe() can be
    modified to match the desired prototype.

    Now that .probe() and .probe_new() have the same semantic, they can
be
    defined as members of an anonymous union to save some memory and
    simplify the core code a bit.

Change-Id: I7dfc626f6bf3db37217e766f763363104ffd2c1f
Signed-off-by: Akshay Gupta <Akshay.Gupta@amd.com>
Signed-off-by: Naveen Krishna Chatradhi <naveenkrishna.chatradhi@amd.com>
---
 sbrmi.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/sbrmi.c b/sbrmi.c
index 2a99c8f..f89b4ba 100644
--- a/sbrmi.c
+++ b/sbrmi.c
@@ -385,8 +385,12 @@ static int sbrmi_i2c_identify_reg_addr_size(struct i2c_client *i2c, u32 *size, u
 	return ret;
 }
 
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6, 3, 0)
 static int sbrmi_i2c_probe(struct i2c_client *client,
 			   const struct i2c_device_id *rmi_id)
+#else
+static int sbrmi_i2c_probe(struct i2c_client *client)
+#endif
 {
 	struct device *dev = &client->dev;
 	struct device *hwmon_dev;
-- 
2.39.3

